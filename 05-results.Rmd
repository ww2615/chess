# Results

## Time and Moves

How does time and the quality of moves correlate?

We can first start by considering the simple case.

### Time Left, Spent by Move Type

The distribution of **Time Left** and **Time Spent** by the type of moves people make.

![](images/Result1.PNG)
![](images/Result2.PNG)
![](images/Result3.PNG)
![](images/Result4.PNG)
```{r}
# library(tidyverse)
# library(hrbrthemes)
# library(weights)
# d = "C:/Users/juhyu/eclipse-workspace/ChessData/600+0_"
# e = ".csv"
# This part of the code didn't run on bookdown
# The same code was ran in a different r environment
# for (i in 1:16){
#   direc = paste(d, as.character(i), e, sep = "")
#   df0 <- read.csv(direc, header = TRUE)
#   df0 <- filter(df0, Type != "Type")
#   df0 <- df0 %>% mutate(
#     Time = ifelse(Time != "0", as.numeric(hms::hms(Time)), 0L),
#     TimeSpent = ifelse(TimeSpent != "0", as.numeric(hms::hms(TimeSpent)), 0L), 
#   )
#   df0 <- filter(df0, Time <= 600 & TimeSpent <= 600)
#   if(i == 1){
#     df1 <- select(df0, Type, Time, TimeSpent)  
#   }
#   else{
#     df2 <- select(df0, Type, Time, TimeSpent)  
#     df1 <- union_all(df1, df2)
#   }
# }
# df2 <- count(df1, Type, Time, TimeSpent)

# df2 <- saved
# ggplot(df2, aes(x = fct_relevel(Type, "blunder", "mistake", "normal", "dubious"), y = Time, weight = n)) + 
#   geom_boxplot() + 
#   xlab("Type") + 
#   ylab("Time Left") +
#   ylim(450, 600)
# ggplot(data = df2, aes(x = Time, weight = n, color = fct_relevel(Type, "normal", "dubious", "mistake", "blunder"))) + 
#   geom_density(size = 3) +
#   xlab("Time") +
#   labs(color = "legend")
# 
# ggplot(df2, aes(x = fct_relevel(Type, "normal", "dubious", "mistake", "blunder"), y = TimeSpent, weight = n)) + 
#   geom_boxplot() + 
#   xlab("Type") + 
#   ylab("Time Spent") +
#   ylim(0, 30)
# 
# ggplot(data = df2, aes(x = TimeSpent, weight = n, color = fct_relevel(Type, "normal", "dubious", "mistake", "blunder"))) + 
#   geom_density(size = 2) +
#   xlab("Time") +
#   xlim(0, 30) +
#   labs(color = "legend")

```

This graph provides a very unique insight to the correlation.

For **Time Left**:

1. **Normal** moves have the biggest std as expected. 

2. People have less **Time Left** after they make a **blunder** or **mistake**

3. **Dubious** moves are mostly made in the first 40 second of the game.

    - This may imply that **dubious moves** are part of the opening.


For **Time Spent**:

1. **Normal** moves are made fast.

    - **Normal** moves may be obvious given the position

    - **Normal** moves may be automatically played during the opening.

2. **Blunder** takes more average time than any other type of move.

    - This is less obvious. We think blunders are made **fast without thought**.

3. **Mistakes** also take more time than **normal** moves.

This is a heatmap of Time Left - Time Spent per type of move.

![](images/Result5.PNG)
```{r}
# ggplot(df2, aes(x = Time, y = TimeSpent)) + 
#   stat_density_2d(aes(fill = ..density..), geom = "raster", contour = FALSE) + 
#   xlab("Time Left") +
#   ylab("Time Spent") +
#   theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
#         panel.background = element_blank(), axis.line = element_line(colour = "black"), strip.background = element_blank()) +
#   facet_wrap(~fct_relevel(Type, "normal", "dubious", "mistake", "blunder")) + 
#   scale_fill_gradient(low = "white", high = "black")
```

It becomes evident that people play **bad** moves **early** in the game

### Time ratio by Move

Let's define **ratio = Time Spent / Time**.

This concept of **ratio** is helpful in the sense that the person could have spent more time considering the position.

For instance, given **1 second** of time left and the player makes a move in **1 second**, then there is less possibility that the player would have detected a better move.

However, given **60 second** of time left and the player makes a move in **1 second** and **blunder**, this is a bad decision and probably the player should have thought more before they made the move.

```{r}
# df2 <- mutate(df2, ratio = TimeSpent / (TimeSpent + Time))
# tb <- df2 %>%
#   group_by(Type) %>%
#   summarise(mean = mean(ratio, na.rm = TRUE), std = sd(ratio, na.rm = TRUE))
# tb <- arrange(tb, mean)
tb <- read.csv("data/tb.csv")
tb
# ggplot(df2, aes(x = Time, y = ratio, weight = n)) + 
#   stat_density_2d(aes(fill = ..density..), geom = "raster", contour = FALSE) + 
#   xlab("Time Left") + 
#   ylab("Time Spent / Time") + 
#   theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
#         panel.background = element_blank(), axis.line = element_line(colour = "black"), strip.background = element_blank()) +
#   facet_wrap(~fct_relevel(Type, "normal", "dubious", "mistake", "blunder")) + 
#   scale_fill_gradient(low = "white", high = "black")

```
![](images/Result6.PNG)

From this graph, 

1. The mean of **normal** moves are much higher than other moves.

    - **Normal** moves are a result of higher ratio of Time Spent / Time.

2. **Dubious** moves are most likely intended or result of bad understanding early on in the game.

3. **Mistakes** and **blunders** are also a result of not enough thinking.

    - Players could have spent **much more time** thinking about the position and not blundering.

